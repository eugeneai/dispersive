import numpy as np
import scipy.optimize as op
import scipy.special as fn
import pylab as p
import math

fwhm_coef=2.*math.sqrt(2.*math.log(2.))
sqrt_2pi=math.sqrt(2.*math.pi)
sqrt_2 = math.sqrt(2.)

def gauss(x, x0, A, fwhm):
    sigma = fwhm/fwhm_coef
    _c=A  #/(sigma*sqrt_2pi)
    _=((x-x0)**2)/(2*sigma**2)
    # print _, _c
    _=np.exp(-_)*_c
    return _

def test1():
    channels=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,2,3,5,8,19,     37,57,110,201,331,602,1006,1683 ,2646,4283,6783,10382,15344,22612,32871,     45971,63336,85157,112676,144016,183174,226837, 275037,324926,376696,428399,     474959,515910,548642,570915,581400,579176,565419,538934,505254, 461770,     414213,363708,312642,263381,217939,176157,139385,108892,83128,61869,45213,     32574 ,22949,15943,10889,7380,4810,3253,2117,1347,976,638,418,323,204,188,     159,141,97,94,83,90,75 ,74,70,57,62,63,75,55,64,34,29,36,27,21,22,16,12,     27,41,37,45,49,37,49,49,84,80,90,154,293 ,638,1374,2277,3247,3821,4012,     3927,3855,3869,3845,3804,3830,3664,3667,3777,3823,3753,3643, 3558,3614,     3482,3457,3609,3542,3428,3452,3319,3393,3426,3346,3229,3312,3223,3258,     3243, 3193,3122,3092,3230,3150,3078,3121,3066,3194,3085,3033,3103,2919,     2902,3038,3121,2866,2951, 2906,2888,2983,2882,2850,2894,2940,2882,2842,     2771,2862,2847,2851,2859,2816,2766,2714,2831, 2719,2757,2810,2723,2713,     2657,2700,2725,2802,2684,2695,2691,2680,2694,2702,2638,2686,2588, 2609,     2653,2534,2605,2608,2579,2569,2624,2622,2525,2580,2578,2565,2640,2614,     2558,2562, 2516,2575,2538,2565,2514,2427,2574,2534,2582,2435,2421,2579,     2456,2484,2436,2384,2562,2390, 2411,2444,2414,2437,2317,2429,2376,2413,     2347,2330,2389,2431,2381,2371,2345,2399,2362,2460, 2423,2322,2348,2318,     2277,2258,2257,2215,2291,2310,2136,2279,2100,2125,2165,2155,2110,2061,      2127,2053,2035,2051,2075,1964,1962,1962,2028,2025,2086,2030,2058,1953,     1992,1970,2053, 2030,2018,1982,2048,2051,1915,2005,2011,2024,2035,1983,     1984,2011,1927,1928,1962,1982,1933, 1822,1908,1869,1891,1980,1897,1892,     1913,1849,2019,2038,2081,2052,2201,2292,2449,2722,2848, 3087,3435,3739,     4232,4698,5115,5805,6294,6984,7817,8285,9215,9612,10265,10762,11107, 11397,11539,11585,11485,11413,11112,10818,10480,9978,9461,8814,8145,     7864,7261,7063,6597, 6120,5824,5501,5286,5048,4717,4667,4578,4489,4594,     4638,4889,5255,5841,6563,7533,8858,10589 ,12603,15007,17943,21444,25399,     29728,34756,40006,45571,51301,56779,62070,67589,72754,77015, 80603,82682,     83931,84935,84480,83473,80914,77332,73071,68805,63644,58770,53293,47728, 42893,37443,32859,29090,25032,22040,18677,16320,14142,12538,10814,9553,     8635,7719,6851,6180, 5835,5144,4935,4759,4436,4241,4113,3948,4005,3913,     3876,3797,3739,3767,3746,3762,3551,3646, 3547,3552,3496,3476,3302,3230,     3143,3133,2981,2872,2830,2718,2697,2707,2492,2549,2441,2362, 2282,2237,     2150,2214,2086,2133,1993,1999,2019,1955,1828,1880,1848,1889,1825,1883,     1840, 1755,1718,1822,1646,1756,1788,1737,1732,1629,1682,1631,1706,1722,     1728,1748,1739,1663,1766, 1756,1761,1682,1812,1765,1754,1874,1809,1825,     1755,1824,1843,1808,1754,1774,1750,1766,1903, 1796,1740,1708,1717,1701,     1639,1704,1752,1712,1602,1701,1614,1631,1661,1633,1677,1625,1581, 1623,     1617,1625,1636,1582,1600,1628,1625,1589,1580,1648,1583,1564,1592,1519,     1599,1657, 1596,1598,1567,1633,1688,1656,1588,1591,1589,1701,1694,1735,     1682,1723,1701,1751,1809,1910, 1847,1838,1926,1890,1966,1998,2019,2017,     1901,2024,1983,1968,1966,1956,1939,1928,1937,1984, 1900,1832,1899,1956,     1924,1836,1903,1946,1973,1957,1953,2051,1960,1953,2019,1977,1964,2016,      1947,1995,2019,1979,2012,1960,2056,1962,1963,1986,1995,1921,1936,1879,     1827,1871,1899, 1880,1899,1809,1919,1848,1877,1852,1876,1909,1910,1929,     2086,1992,2188,2146,2142,2131,2084, 2225,2147,2127,2219,2271,2259,2285,     2263,2204,2168,2115,2151,2159,2094,2103,1994,2014,1948, 1971,2018,1952,     1917,2014,1963,2021,1857,1999,1982,2018,2012,2059,2069,2099,2137,2173, 2181,2214,2364,2442,2522,2616,2822,3152,3353,3737,4123,4704,5483,6301,     7434,8758,10371, 12037,14287,16829,20204,23741,27753,32321,37330,42397,     48679,54519,61426,68407,75284,81925, 88818,95139,101377,106392,110984,     114684,117829,119732,119976,119714,118406,115420,111845, 107262,101514,     96162,89506,83032,75387,69004,62465,54984,48873,42564,37661,31846,27707, 23633,20132,17132,14310,12154,10238,8846,7672,6659,5952,5450,5033,4894,     4779,4965,5148,5457 ,5838,6236,6847,7528,8474,9119,10153,11196,12524,     13895,15265,16646,18467,20479,22489,24838 ,27217,30123,33336,36433,40748,     44573,49188,53508,59492,64830,71255,77696,83567,90527,97050, 103143,109422,     114846,120182,124433,128548,130701,132814,132637,132333,131539,128022, 124166,119944,115248,108549,101801,95079,87876,80181,72321,65021,58187,     51734,45219,39529, 34086,29596,25072,21297,17662,15030,12621,10451,8765,     7566,6296,5375,4622,3994,3623,3338, 3168,3019,2963,3065,3061,3299,3614,     3563,4076,4381,4782,5202,5783,6457,7147,7807,8476,9415, 10250,10991,11957,     12926,13833,14615,15297,16154,16808,17560,17770,18109,18157,18342,18451,      17854,17837,17078,16610,16147,15275,14054,13365,12629,11398,10717,10014,     8846,8031,7190 ,6487,5882,5208,4515,4210,3690,3267,3008,2713,2427,2226,     2044,1878,1757,1706,1597,1592,1521 ,1412,1429,1346,1407,1385,1386,1342,     1365,1366,1425,1428,1387,1304,1392,1435,1334,1401,1494 ,1437,1499,1515,     1470,1614,1695,1641,1691,1871,1912,2067,2213,2426,2634,2889,3154,3545,      3960,4579,5048,5854,6645,7437,8680,9697,11061,12439,14091,16037,17444,     19398,21623, 23682,25559,27680,29667,32011,34128,35834,37527,38856,41119,     41379,42055,42299,42951,42888, 41962,41292,40570,39615,37550,35993,34197,     32387,30324,28645,26050,24065,22446,20491,18664, 16961,15249,14004,12634,     11437,10615,9996,9112,8449,7884,7353,7042,6515,6412,6093,5831,5566 ,5308,     5070,4736,4743,4598,4263,4308,4015,3929,3800,3844,3741,3733,3758,3756,     3819,3978 ,4098,4173,4423,4591,4890,5124,5170,5433,5749,6002,6119,6402,     6752,6838,7150,7315,7697,7683 ,8210,8194,8411,8418,8766,8755,8824,9316,     9391,9347,9663,9494,9572,9470,9577,9397,9381,8930 ,8790,8799,8545,8386,     8006,7676,7159,6827,6554,6221,5768,5499,5247,4806,4479,4209,3781,3715 ,     3446,3173,3018,2771,2597,2511,2421,2384,2297,2258,2187,2219,2233,2229,     2210,2203,2221 ,2302,2352,2320,2377,2456,2433,2433,2500,2449,2502,2451,     2506,2502,2564,2481,2521,2549,2502 ,2345,2457,2409,2432,2319,2413,2218,     2358,2323,2344,2320,2308,2352,2248,2337,2265,2180,2297 ,2184,2071,2223,     2235,2169,2166,2136,2242,2150,2104,2083,2100,2124,2081,2057,2130,2063,      2082,2040,1999,2038,1963,2018,2006,1880,2029,2033,2178,2015,2119,2073,     2096,2136,2114, 2096,2105,2176,2175,2161,2124,2222,2210,2150,2301,2229,     2331,2208,2278,2300,2268,2214,2138, 2254,2273,2185,2131,2125,2050,2060,     2125,1969,2036,2042,2026,1951,1913,1904,1956,1870,1884, 1906,1785,1907,     1943,1892,1781,1882,1964,2067,1947,2009,2076,2185,2216,2212,2284,2349, 2535,2660,2885,2966,3042,3428,3490,3972,4168,4674,4979,5325,5888,6334,     6893,7398,8138,8778, 9488,10231,11096,11595,12222,12856,13790,14385,14831,     15384,15922,16191,16514,16603,16918, 16960,16844,16634,16216,16028,15739,     15095,14406,14047,13017,12704,11662,11099,10368,9813, 8930,8418,7758,7305,     6841,6249,5924,5398,5062,4769,4467,4293,4189,3985,3846,3609,3629,3649,      3554,3495,3529,3481,3593,3542,3555,3665,3704,3833,3966,3926,4121,4248,     4307,4378,4631, 4886,5101,5375,5707,5996,6390,7071,7483,8226,9117,10424,     11884,13838,15550,18256,21663, 25321,29942,34933,41444,49066,57880,68104,     79097,93206,108467,125905,145302,167334,190234, 215787,243561,273199,     305256,338845,374630,410922,447619,483237,521626,558315,594427,626179,      658777,687807,714286,735083,753942,768135,775673,779820,776828,774598,     761417,747270, 727100,702896,676692,648849,613594,582254,544090,508350,     471945,433457,396586,361645,326468, 292739,260941,232228,205463,179433,     157424,136009,118031,101327,86412,73683,61835,52204, 44458,36845,31104,     25587,21165,17464,14641,12186,10135,8603,7178,6219,5488,4783,4156,3760,      3399,3246,3044,2841,2722,2618,2622,2597,2415,2371,2343,2358,2337,2420,     2323,2244,2332, 2318,2252,2318,2318,2331,2373,2427,2365,2428,2423,2441,     2590,2601,2564,2652,2751,2826,2836, 2938,3091,3157,3261,3491,3692,3802,     4038,4317,4604,4881,5410,5745,6143,6805,7512,8415,9355, 10347,11487,13033,     14368,16448,18217,20398,22655,25103,27986,31235,34530,38595,42181,46464,      50155,54478,59007,63727,68130,72736,77388,81520,85569,88531,92392,94732,     97444,99007, 101002,102329,102220,101955,101542,99811,98312,95524,92644,     89335,85911,81682,77613,73085, 68070,63993,58972,54656,50349,45765,41363,     37333,34125,29786,26653,23578,20667,18214,15789, 13963,11999,10409,8899,     7752,6463,5482,4735,4054,3477,2969,2463,2253,1836,1577,1363,1231, 1061,     997,925,874,761,739,692,665,649,605,636,558,552,591,595,558,562,562,     543,563,536, 526,572,571,593,581,580,547,539,561,541,578,586,550,561,     541,574,542,539,507,539,591,489, 506,517,476,493,462,486,454,454,465,     423,441,436,444,440,412,384,444,416,421,400,419,371, 390,384,433,404,     447,403,429,372,382,422,396,417,438,448,421,421,393,425,392,382,374, 398,409,389,413,409,406,442,424,441,398,417,379,445,435,436,463,418,     446,421,469,457,505, 470,477,477,495,470,463,538,511,574,526,526,491,     588,585,557,591,615,602,656,628,698,708, 714,765,793,844,862,898,932,     1024,1049,1102,1170,1147,1234,1273,1323,1348,1379,1403,1517, 1569,1495,     1598,1600,1607,1582,1629,1679,1635,1680,1652,1589,1547,1512,1491,1518,     1482, 1339,1363,1321,1275,1237,1203,1149,1079,1046,995,986,935,972,844,     811,821,750,755,770,729, 640,578,600,604,541,542,483,498,483,477,445,488,     414,451,426,432,399,401,408,424,405,368, 425,417,374,393,389,376,380,413,     387,400,413,404,400,413,393,420,403,389,432,441,403,412, 430,449,429,462,     508,487,482,566,510,589,635,679,688,788,847,900,954,1074,1108,1254,1349,      1437,1507,1667,1778,1869,2021,2163,2177,2436,2500,2611,2746,2860,2917,3023,3010,3066,3192,  3207,3223,3239,3238,3191,3092,3063,3042,3005,2781,2819,2645,2469,2453,2375,2175,2103,2022,1891 , 1805,1649,1514,1454,1303,1287,1120,1026,1033,963,902,806,756,695,614,681,610,610,536,603,557,  537,483,502,493,505,492,493,487,552,478,500,520,471,501,533,578,508,528,497,501,492,487,478, 476 ,497,460,494,467,488,470,471,453,447,453,427,452,478,469,434,463,429,378,434,470,430,403, 470, 456,441,465,432,483,472,471,504,509,552,582,578,688,601,650,662,752,758,751,832,886,898, 959,992 ,1019,1100,1132,1167,1153,1170,1222,1294,1303,1307,1324,1356,1291,1352,1310,1332,1349, 1256,1258 ,1247,1182,1181,1116,1095,1050,1015,1014,1000,977,868,838,757,772,715,668,672,590,591 ,597,509, 572,472,521,480,476,454,460,423,438,405,441,401,455,423,450,462,441,466,489,530,515, 505,587,557 ,585,572,586,608,608,686,690,749,695,741,739,798,792,773,830,805,792,808,821,841, 823,863,864, 869,870,863,915,924,905,862,902,896,893,889,835,869,889,915,912,913,860,799,827, 802,812,809,807 ,758,770,740,746,733,734,669,671,656,617,637,584,567,595,542,558,533,520,520, 502,477,480,449, 497,471,490,425,491,438,465,464,430,484,484,500,481,506,460,459,512,482,520, 522,494,549,582,584 ,585,654,622,610,634,654,674,671,704,722,736,722,747,806,812,772,783,792, 852,829,814,873,871, 835,838,790,810,771,798,756,763,808,738,735,700,663,676,659,628,625,597, 591,565,559,567,571,552 ,564,503,592,517,548,546,501,492,487,472,489,549,539,510,547,508,561, 497,506,507,507,507,524, 507,530,528,578,567,530,541,563,563,557,551,569,543,571,625,608,586, 627,664,625,684,656,725,775 ,737,779,763,825,851,837,885,926,877,969,964,1026,983,1014,1031, 1077,1142,1094,1093,1145,1125, 1093,1106,1131,1117,1116,1067,1102,1100,1029,953,976,923,924,897 ,902,846,832,718,706,685,698, 660,641,659,576,584,557,521,560,498,491,506,498,440,467,432,436, 440,412,410,408,427,413,409,408 ,434,423,437,409,429,451,445,435,430,484,457,459,445,424,452, 445,473,486,466,472,503,513,449, 467,492,479,490,455,515,489,484,470,464,463,466,472,464,412, 414,447,418,434,416,385,397,374,374 ,368,388,353,383,381,353,354,362,328,363,327,363,326,368, 365,298,317,346,309,329,352,353,346, 330,328,329,331,349,327,336,322,330,333,305,346,326,306, 298,319,343,335,350,348,343,335,325,344 ,373,333,344,339,317,331,365,322,330,368,364,312,361, 357,350,322,347,352,335,367,330,334,367, 311,378,362,356,351,336,360,327,325,328,308,316,316, 319,340,341,334,285,338,306,337,350,336,303 ,316,324,365,312,310,340,323,335,323,312,344,363, 356,330,341,361,336,368,355,324,305,312,337, 358,375,343,341,331,349,341,340,354,374,342,339, 375,382,338,366,359,311,386,342,332,374,372,375 ,341,376,393,343,353,426,408,381,404,405,436, 446,456,441,454,486,459,518,537,531,505,536,561, 582,614,637,657,620,683,659,713,730,744,769, 750,790,704,751,763,755,765,789,782,748,757,712,739 ,687,666,684,665,632,619,609,632,582,605, 580,550,586,515,485,479,490,474,473,445,444,418,442, 379,407,414,387,385,361,377,405,347,351, 393,422,397,359,401,363,383,360,382,390,373,382,400,358 ,394,397,377,388,375,426,408,390,423, 411,429,441,438,438,444,466,460,433,428,450,472,460,457, 441,431,434,461,453,427,473,432,410, 417,487,424,476,450,427,448,405,436,431,448,419,403,439,436 ,485,431,430,463,424,464,395,483, 475,455,542,524,546,532,516,609,595,599,602,668,621,720,768, 731,761,776,754,862,856,850,959, 921,981,950,1007,1098,1059,1086,1152,1206,1135,1193,1169,1215, 1304,1297,1320,1432,1435,1441, 1444,1558,1544,1561,1666,1622,1687,1735,1706,1809,1922,1853,1957, 1980,1855,2026,2071,2063,2087 ,2083,2160,2026,2001,2086,1998,2036,2043,1850,2014,1932,1977,1852, 1856,1830,1760,1718,1646, 1602,1545,1482,1490,1399,1328,1363,1265,1147,1177,1163,1132,1085,1033, 981,988,898,887,802,800, 811,776,799,733,741,759,660,667,678,660,617,631,633,594,584,569,623,578 ,568,539,599,603,600, 573,582,571,579,588,543,587,597,597,585,593,632,615,639,669,709,742,744, 815,831,906,927,1022, 1109,1154,1222,1233,1433,1491,1510,1589,1797,1865,2050,2157,2319,2481,2637 ,2890,2977,3190,3339 ,3569,3610,3934,4048,4325,4415,4604,4699,4876,5154,5265,5369,5545,5493,5575 ,5714,5789,5928, 5949,5938,5901,5971,6014,5815,5825,5694,5445,5487,5355,5247,5055,5067,4806,4672 ,4395,4275,4221 ,3947,3749,3543,3348,3222,3054,2945,2787,2604,2406,2245,2114,2044,1884,1749,1658 ,1565,1463, 1299,1304,1251,1141,1083,1092,1028,964,994,903,857,836,859,793,818,773,760,735,748, 731,708,700 ,691,705,653,634,704,654,632,655,653,657,644,662,641,668,634,647,704,649,745,647,683 ,693,639, 653,658,674,699,680,703,693,703,736,748,789,823,791,800,855,872,898,1015,1041,1068, 1109,1218, 1220,1404,1510,1540,1738,1817,1982,2202,2325,2646,2878,3206,3485,3670,4058,4471,4918, 5435,5839 ,6223,6807,7378,7976,8547,9078,9894,10645,11095,11836,12840,13688,14167,15154,15724, 16561, 17293,18288,18947,19378,19981,20523,21206,21811,22148,22725,23021,23501,23484,24094,24134, 24343 ,23961,24013,23799,23665,23163,22917,22345,22123,21724,21032,20517,19743,18822,18350,17587, 16713,15958,15276,14155,13727,12844,12159,11319,10702,9829,9350,8668,7704,7460,6801,6141,5842, 5202,4768,4323,4061,3614,3327,3121,2885,2520,2337,2158,1886,1870,1730,1591,1432,1405,1301,1237,  1199,1169,1071,1019,1033,958,981,964,884,862,846,923,834,824,894,875,840,851,877,859,920,887, 895,867,887,854,910,865,875,808,871,878,958,925,912,931,884,871,878,967,916,921,911,948,949,956  ,984,982,996,1031,961,1041,1030,1013,1048,1020,1122,1103,1197,1122,1168,1166,1216,1234,1233, 1295,1321,1279,1321,1359,1422,1501,1541,1586,1627,1657,1704,1859,1727,1795,1911,2012,2047,2109,  2182,2233,2372,2375,2429,2618,2632,2646,2819,2847,2967,2976,3065,3023,3187,3191,3252,3368,3350 , 3418,3437,3542,3461,3458,3511,3544,3605,3548,3443,3326,3437,3586,3380,3396,3297,3219,3206, 3163, 3092,3023,2976,2936,2734,2615,2818,2729,2598,2544,2460,2415,2396,2372,2250,2216,2178,2002 ,2165, 2090,2082,2023,2056,1939,1974,2051,1931,1938,1982,1964,1897,1846,1883,1966,2008,1899, 1969,1926, 1908,1996,1953,2028,2009,2025,1915,2046,1998,2061,1990,2101,2036,2030,2029,2042,2027 ,2130,2151, 2119,2166,2223,2121,2257,2279,2244,2273,2283,2327,2293,2312,2369,2358,2360,2392, 2417,2363,2406, 2412,2414,2546,2521,2464,2518,2594,2618,2549,2593,2476,2527,2649,2715,2669,2748 ,2771,2857,2879, 2899,2890,2891,2918,2951,3018,3002,3051,3043,2934,2993,3157,3185,3129,3221, 3209,3315,3229,3319, 3464,3528,3518,3502,3581,3686,3719,3680,3906,3961,3879,4055,4047,4077,4175 ,4332,4317,4543,4551, 4593,4900,5017,5080,5130,5134,5246,5417,5657,5901,5936,6033,6210,6405, 6483,6542,6749,6880,6936, 7268,7295,7427,7547,7646,7791,7877,7874,7904,7968,7904,8078,8153,8134 ,8180,8297,8417,8148,8254, 8220,8162,8079,8301,8386,8126,7987,8058,7976,8113,7981,7881,7965, 7998,7926,7691,7673,7966,7705, 7818,7832,7991,7773,7780,7855,7921,8039,8144,8044,8151,8335,8503 ,8342,8485,8642,8727,8968,9037, 8973,9286,9472,9467,9649,9633,9852,10087,10324,10455,10544, 10671,10723,10915,11142,11511,11370, 11767,11854,12030,12100,12551,12617,12970,13156,13173,13556 ,14035,13927,14554,14687,14774,15226, 15195,15757,16083,16156,16280,16907,17065,17712,17816, 18071,18382,18764,19315,19362,19550,20389, 20653,20877,21672,21694,22271,22445,22773,23473,23780 ,24216,24612,24919,25419,25889,26356,26655, 27013,27463,28239,28932,29076,29406,30525,30579, 31144,31481,31670,32470,32822,33354,33483,34402, 34691,35146,35908,36336,36851,37150,37975,38026 ,38632,39310,39664,40183,40102,41029,41434,42113, 42382,42752,43332,43589,44660,45201,45332, 45652,46371,46950,47189,47419,48039,48300,48845,49391, 49563,50736,50760,50813,51345,51783,52317 ,52077,53156,53270,53428,53676,54473,54911,55191,55081, 55411,56022,56171,56415,56042,57405, 57315,57685,58210,58000,58331,58283,58735,59244,59623,59415, 59791,59853,60559,60735,60174,60449 ,60685,61229,61318,61072,61579,61947,61542,61872,62304,62042, 62301,62212,62331,62645,62827, 63027,62745,62643,63126,63198,63308,63000,63625,63539,63314,63434, 63613,63732,63337,63586,63961 ,63401,63664,63382,63363,63167,62516,63287,63164,63811,63358,62960, 63058,63298,63002,62929, 62864,62814,62547,62532,62245,62734,62170,62748,61913,62155,62169,61630, 61773,61329,61714,61168 ,61225,61584,61449,61443,61247,61445,61816,61913,61766,61879,62553,62069, 62767,62801,63584, 64331,65020,65601,65916,66887,67793,69130,69897,71488,72783,73867,75168,76931, 78633,79978,82379 ,83725,86025,87889,90032,92146,94860,97142,99208,102240,103899,106554,109281, 111729,114053, 116401,119073,121053,123172,125016,127208,129671,131055,132664,134543,135633, 137326,137801, 138699,139156,139417,138971,139652,139539,138118,137578,136973,135182,133500, 131798,130274, 128197,125389,123221,120332,117842,113851,110543,107432,103640,99809,95733,92327, 88210,84098, 80526,76943,72796,68490,65378,61465,57688,54128,50967,47401,44181,41497,38624,35151, 33068,30305 ,28066,25714,23793,21736,19949,18203,16443,15365,13955,12837,11643,10445,9662,8778, 8183,7438, 6737,6171,5828,5194,4740,4440,4057,3794,3737,3372,3131,2918,2779,2639,2519,2386,2240, 2142,2173 ,2094,1989,1886,1801,1704,1635,1641,1624,1532,1478,1410,1384,1379,1345,1317,1213,1288, 1215, 1177,1164,1123,1108,1072,1001,1032,1021,973,933,874,881,886,796,813,772,799,802,744,770, 711, 679,689,685,628,659,635,583,613,577,617,563,525,571,553,526,501,487,470,502,476,462,464,449 , 429,432,419,440,394,458,371,386,368,364,358,339,353,329,360,280,335,323,322,291,314,281,289, 269,324,286,264,265,309,280,266,235,268,269,251,250,238,233,274,257,226,256,229,235,245,227,248  ,223,197,202,214,224,203,184,185,195,218,219,212,202,214,201,182,191,207,195,175,180,193,197, 169,194,179,189,182,216,179,181,190,176,131,195,188,187,174,181,160,180,159,163,173,152,194,173  ,179,181,170,172,173,166,182,159,202,176,167,151,172,147,167,175,182,155,171,148,149,159,171, 163,161,138,150,159,159,141,171,150,156,169,130,148,144,154,148,125,150,148,159,149,155,149,152  ,124,125,155,157,155,124,146,175,145,152,156,136,153,139,156,160,151,143,144,141,157,153,150, 145,164,141,149,155,151,126,142,163,163,159,147,153,158,154,172,160,161,166,175,156,157,155,158  ,153,170,174,166,167,147,190,174,168,152,190,172,162,176,164,189,177,150,150,182,159,171,190, 156,134,161,191,152,163,163,145,144,132,119,140,169,152,146,142,138,128,134,130,131,147,104,139  ,100,114,108,106,116,91,94,120,117,101,94,93,79,78,92,86,100,86,110,87,95,86,101,75,86,79,78, 88,75,91,91,94,97,84,80,82,95,96,112,102,92,91,97,106,98,101,99,116,90,118,104,128,130,126,95, 130,114,117,113,113,107,128,130,127,128,131,124,112,135,130,129,118,118,101,111,140,122,130,123  ,111,115,117,118,102,108,126,99,132,102,96,107,103,91,100,115,96,78,98,121,109,107,95,81,125, 107,71,92,100,99,109,111,94,86,107,89,99,101,98,88,89,89,111,85,80,93,97,85,124,95,96,119,99, 87,96,113,110,89,107,103,116,92,103,104,114,104]
    plastic=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,14,31,38,74,164,246,477,811,1299,2247,3567,5642,8565,13142,19457,28502,40365,55624,76541,101225,132192,168113,210436,256771,305809,358263,409224,456630,500519,538105,562950,576847,580403,569609,548119,517206,477429,431533,381562,331294,281218,234641,192011,152976,120943,93226,70067,52237,38423,27557,19602,13581,9300,6346,4287,2975,1961,1287,932,657,504,340,254,249,186,161,153,129,93,109,100,97,101,102,86,95,82,61,76,46,52,39,37,22,24,31,52,155,174,175,189,180,184,180,200,222,229,261,396,752,1586,2867,4180,5356,5857,6110,6003,6121,5923,5942,5870,5738,5755,5885,5617,5622,5711,5652,5515,5591,5469,5342,5419,5403,5324,5359,5233,5234,5249,5265,5260,5231,5153,5195,5126,5129,5181,5077,5047,4889,5071,4992,4927,4948,4932,4811,4792,4879,4955,4851,4906,4716,4730,4764,4671,4723,4718,4656,4650,4881,4806,4687,4627,4742,4605,4678,4590,4625,4667,4592,4516,4618,4689,4567,4668,4440,4470,4463,4522,4624,4451,4565,4516,4526,4556,4459,4421,4471,4411,4364,4443,4296,4552,4383,4406,4427,4590,4446,4513,4339,4330,4250,4418,4319,4421,4290,4278,4293,4128,4346,4232,4319,4322,4188,4204,4292,4228,4162,4315,3994,4201,3918,4070,4059,4030,3935,4069,3901,3840,3940,3728,3763,3766,3680,3758,3766,3669,3599,3701,3605,3638,3604,3492,3420,3415,3381,3411,3282,3279,3206,3168,3136,3162,2989,3008,2961,3037,2817,2911,2996,2886,2826,2806,2730,2736,2609,2597,2567,2553,2487,2562,2508,2511,2372,2443,2413,2215,2416,2259,2326,2255,2223,2167,2136,2123,2170,2057,2105,2001,2062,2072,2054,2003,2009,2037,1938,1918,1888,1924,1884,1853,1925,1821,1827,1847,1879,1841,1886,1796,1763,1867,1777,1754,1721,1787,1717,1773,1690,1771,1775,1711,1766,1757,1730,1764,1716,1735,1697,1674,1623,1747,1650,1567,1635,1573,1539,1604,1638,1584,1562,1562,1518,1502,1562,1505,1524,1548,1451,1518,1494,1459,1506,1475,1469,1409,1408,1425,1407,1417,1478,1404,1384,1344,1397,1436,1297,1414,1447,1341,1358,1426,1387,1429,1458,1423,1424,1487,1397,1453,1463,1466,1460,1445,1486,1406,1417,1506,1443,1444,1438,1383,1391,1419,1405,1377,1309,1373,1371,1379,1422,1384,1410,1353,1417,1494,1501,1472,1447,1505,1405,1397,1487,1521,1575,1489,1477,1571,1490,1572,1574,1551,1624,1570,1650,1583,1575,1621,1590,1586,1506,1514,1471,1535,1554,1492,1511,1567,1496,1499,1493,1467,1525,1514,1456,1402,1446,1406,1533,1439,1397,1380,1407,1363,1420,1393,1326,1317,1325,1346,1330,1382,1337,1308,1350,1357,1371,1398,1367,1359,1388,1433,1492,1486,1544,1575,1634,1830,1816,2018,2239,2251,2316,2588,2706,2832,3153,3219,3340,3609,3544,3753,3575,3896,3791,3902,3771,3735,3623,3511,3401,3209,3135,2936,2789,2552,2383,2254,2093,1961,1967,1817,1718,1620,1589,1482,1446,1410,1401,1424,1339,1416,1382,1379,1413,1298,1345,1381,1260,1291,1303,1284,1304,1341,1192,1241,1285,1198,1169,1127,1237,1227,1173,1168,1208,1166,1163,1083,1178,1151,1128,1170,1219,1167,1202,1121,1119,1122,1128,1122,1158,1154,1140,1113,1229,1070,1087,1083,1089,1032,1082,1075,1064,1126,1112,1035,1074,1110,1058,1095,1069,1036,1040,983,1060,1071,1058,1027,1038,1105,1059,1094,1018,1029,1022,1053,995,1091,1097,1068,1071,1027,1081,947,979,1053,1084,1105,1061,1013,1048,1053,1192,1126,1136,1175,1219,1220,1222,1195,1215,1193,1256,1225,1184,1213,1196,1208,1236,1243,1213,1195,1144,1125,1121,1096,1090,1140,1147,1085,1070,1080,1006,1073,1009,1053,1038,972,951,1032,959,997,1029,957,956,1021,1006,1037,1029,1001,1014,1072,1039,1014,972,1051,995,990,1027,975,1008,1020,1035,1056,1029,1027,1053,1095,1073,1016,1115,1084,1094,1113,1100,1143,1147,1164,1194,1167,1180,1173,1176,1162,1131,1210,1216,1149,1176,1227,1223,1182,1214,1168,1110,1113,1141,1127,1048,1088,1015,1035,1066,1004,955,997,990,1010,972,998,980,1013,964,993,966,950,1017,995,1017,1012,957,1018,1012,1031,1116,1058,1121,1136,1226,1284,1410,1521,1584,1742,1850,2057,2359,2649,3104,3534,4030,4489,5189,5979,6961,7872,8658,9785,10999,12198,13274,14552,15609,16802,17947,18497,19494,20176,20783,21366,21414,21322,21280,20964,20423,19866,19008,18164,17238,16164,14992,13608,12403,11407,10314,9142,8123,7298,6366,5683,4799,4102,3790,3198,2807,2437,2143,1957,1681,1542,1463,1356,1231,1224,1179,1116,1080,1141,1122,1109,1184,1229,1240,1307,1335,1437,1525,1595,1677,1804,1851,2049,2245,2268,2316,2610,2679,2745,2819,2960,3088,3174,3325,3357,3439,3421,3274,3426,3366,3243,3055,3058,3022,2877,2679,2550,2347,2208,2186,1976,1832,1698,1548,1483,1404,1314,1187,1193,1120,1050,1018,939,973,920,868,870,845,824,845,831,856,858,854,817,794,782,764,824,789,786,816,756,758,765,815,855,793,783,812,788,760,786,820,826,762,816,792,770,811,854,822,813,849,751,761,786,750,797,790,802,782,806,774,801,828,768,802,785,808,822,797,889,849,805,760,839,833,819,777,817,860,790,855,811,828,833,842,804,794,830,813,825,831,746,792,789,795,798,789,767,771,732,778,818,779,728,768,732,797,838,798,751,773,774,749,799,758,748,762,753,795,779,754,751,757,744,723,770,730,715,764,752,764,778,785,754,789,750,775,702,694,772,749,794,747,731,732,734,706,721,757,772,765,763,735,734,794,753,784,760,702,770,740,706,742,749,746,768,719,754,752,746,788,711,754,801,762,794,725,711,716,723,736,750,693,731,741,728,741,731,711,739,734,703,734,707,686,730,711,667,779,703,736,710,706,717,713,691,763,727,731,744,716,730,764,733,731,706,734,738,716,739,749,691,692,677,676,721,702,723,733,724,732,694,688,668,678,737,720,753,668,691,693,785,769,689,723,705,749,703,704,757,711,692,724,700,677,768,744,764,714,701,763,713,756,709,722,700,775,723,749,707,761,691,709,738,742,656,745,708,706,683,733,697,677,689,693,724,660,675,704,697,672,714,665,686,736,685,670,695,710,688,698,691,694,688,658,663,692,683,679,685,681,718,680,657,673,673,676,681,702,695,663,703,733,660,682,712,717,678,712,714,687,689,714,710,711,659,692,710,678,694,674,692,646,664,705,662,676,696,663,644,720,711,682,710,740,711,731,702,696,713,717,725,656,730,676,674,709,675,708,663,707,688,631,704,674,711,701,740,656,699,689,661,640,692,651,691,737,688,665,690,667,686,660,676,664,697,658,685,675,653,679,649,698,667,709,721,671,719,636,691,667,680,657,694,671,667,721,693,683,684,710,670,656,727,768,731,775,759,763,754,741,759,818,823,835,1005,986,1035,997,1065,1130,1213,1291,1298,1360,1435,1550,1614,1631,1739,1741,1842,1921,2004,2059,2009,2089,2044,2073,2072,2034,2133,1956,1980,1947,1948,1849,1728,1739,1634,1632,1494,1502,1389,1338,1325,1177,1152,1067,1054,1011,951,946,895,831,792,801,772,761,740,730,689,715,708,673,685,708,682,661,715,705,644,610,653,665,661,650,675,628,638,655,651,633,662,653,633,666,651,654,618,602,648,698,686,638,632,596,609,583,644,670,637,636,659,635,642,637,631,696,697,628,651,641,675,639,638,691,670,699,644,644,629,661,610,643,661,651,679,663,680,683,652,671,691,657,666,637,720,676,716,731,721,736,711,711,791,816,742,769,789,750,785,790,792,787,801,844,841,831,836,822,857,834,866,834,790,770,774,816,732,806,747,753,740,757,705,750,686,720,696,676,759,617,655,684,668,645,651,637,665,623,647,646,640,643,633,617,652,574,623,639,643,606,619,654,615,658,637,606,627,648,670,678,656,635,646,673,639,605,709,639,673,649,655,700,674,659,637,664,729,690,689,704,717,707,706,706,708,720,760,723,748,733,741,713,709,751,640,717,707,724,730,723,702,704,666,734,661,663,664,637,648,661,674,664,679,623,661,669,598,651,625,677,664,628,637,663,627,634,635,630,606,641,651,633,598,627,605,597,623,610,669,619,644,643,587,615,621,647,659,664,632,659,613,629,634,627,599,621,616,651,651,672,615,633,640,656,636,676,703,690,724,728,681,648,768,780,778,850,793,902,864,925,965,967,1111,1083,1129,1204,1290,1373,1382,1421,1487,1555,1609,1630,1674,1821,1879,1868,1969,1943,2013,2076,1985,1953,2079,1937,1968,1954,1911,1895,1813,1740,1730,1671,1587,1620,1472,1433,1397,1349,1309,1265,1150,1137,1022,1072,969,932,859,847,797,853,786,764,735,712,764,738,711,694,672,657,662,636,653,641,630,670,625,665,654,644,625,656,684,629,615,633,628,642,664,641,612,626,641,602,627,590,671,646,631,661,645,611,595,600,631,629,644,612,599,660,605,666,641,626,671,673,651,691,702,642,681,695,724,740,787,743,737,785,863,855,896,935,919,1062,959,1020,966,1103,1060,1126,1109,1146,1196,1163,1209,1191,1249,1276,1233,1238,1248,1233,1256,1225,1163,1182,1126,1144,1177,1091,1081,1072,1039,955,990,923,980,947,856,858,869,827,782,765,778,710,755,719,733,730,713,665,686,701,730,715,703,723,750,738,809,774,742,800,757,799,817,744,802,765,796,750,824,797,814,834,743,826,725,796,705,744,765,735,692,802,771,695,759,669,698,667,735,680,623,652,679,651,678,600,663,681,653,626,649,607,652,644,644,597,598,604,600,622,645,657,608,623,614,632,613,653,604,633,642,610,633,629,572,642,604,613,679,616,594,674,653,636,655,693,662,656,628,690,629,615,652,609,652,603,687,627,638,652,638,605,585,660,654,652,638,634,591,622,636,676,610,571,622,647,609,622,623,643,588,631,596,615,616,648,646,623,666,642,633,641,634,627,713,668,628,671,691,685,684,713,697,717,687,710,675,696,706,644,668,712,680,665,693,686,657,694,668,692,680,688,741,714,691,717,720,684,654,650,673,685,662,655,625,664,701,673,643,664,616,648,651,659,658,642,592,600,639,623,626,626,703,604,606,600,597,651,638,653,617,680,669,613,653,591,611,670,630,620,587,633,625,575,616,604,651,631,597,622,692,675,629,639,645,646,603,660,634,629,609,600,592,626,640,635,587,649,652,610,646,644,658,646,683,630,617,659,643,592,662,616,605,656,606,633,629,642,648,613,551,658,627,649,700,627,629,636,671,637,620,654,658,620,589,650,652,610,668,625,614,641,606,632,632,627,612,654,578,696,613,605,643,660,651,652,658,676,656,642,654,659,635,665,631,608,635,654,641,679,641,673,699,661,724,669,681,685,703,690,665,689,708,745,760,695,697,733,737,767,723,774,729,742,768,765,705,826,783,794,803,792,812,786,820,844,762,816,799,835,810,838,799,800,783,754,758,798,785,736,782,777,803,726,714,719,787,730,714,752,715,723,761,675,674,654,657,704,633,662,739,626,709,709,658,708,689,662,691,641,685,700,674,633,659,681,726,732,665,680,702,706,678,730,687,668,709,680,702,668,670,695,723,702,703,722,678,708,672,702,724,691,683,672,738,694,703,725,665,687,667,669,675,688,686,713,682,672,673,677,702,704,688,703,662,706,664,712,666,785,735,691,698,710,706,695,722,676,691,635,668,709,693,743,728,692,690,721,683,673,685,686,700,703,684,699,753,708,711,725,693,680,720,791,773,688,701,693,691,709,757,754,721,736,750,725,722,707,734,744,753,720,731,762,739,752,736,760,747,729,701,725,705,761,768,724,699,738,777,710,765,748,705,747,742,678,750,705,798,752,747,772,716,783,709,721,722,799,745,688,757,717,712,751,728,724,792,762,780,707,744,754,762,699,789,757,772,728,682,755,734,723,783,755,752,766,765,750,725,796,726,728,756,757,789,756,764,770,788,798,766,773,790,805,748,765,763,713,731,760,734,775,779,751,774,774,801,775,828,770,779,809,822,772,773,828,767,822,797,805,794,827,797,850,802,856,820,800,847,828,771,880,786,814,836,800,856,813,863,800,739,781,760,825,862,799,828,788,824,795,779,790,768,769,780,821,770,784,834,788,826,813,790,855,787,810,851,803,807,845,862,825,852,820,852,855,876,850,838,845,797,869,800,873,863,808,824,819,786,876,837,845,827,842,835,858,816,862,812,847,846,854,820,836,855,871,859,889,852,870,904,892,799,867,860,853,876,844,848,895,854,849,869,838,874,815,893,856,911,841,830,891,876,902,900,845,873,938,897,939,916,920,932,880,916,984,968,952,908,958,1025,936,1025,1017,986,966,991,942,977,1035,1117,1069,1024,1010,1025,1040,1044,1023,1023,1021,1054,1055,1053,1093,1044,995,1133,1057,1044,1044,1046,1048,1030,988,996,1056,1036,961,986,995,1018,986,977,1023,948,968,1016,975,954,1041,948,948,975,968,972,909,927,973,986,1009,953,894,919,1005,994,915,935,963,955,945,912,949,964,997,935,1000,954,1010,1029,997,1008,1068,1051,996,984,1021,1009,1029,1004,1025,1003,984,1041,1081,1009,1098,1027,948,987,976,1082,1039,997,1041,1049,1066,1050,1039,1044,1053,1049,1094,1013,1065,1062,994,1107,996,1056,1030,1061,1057,1092,997,1028,1067,1062,1013,1033,1052,1098,1104,1095,1094,1141,1077,1060,1159,1119,1115,1086,1059,1116,1088,1089,1118,1114,1107,1072,1150,1121,1106,1149,1106,1109,1120,1098,1148,1105,1173,1091,1129,1122,1174,1108,1117,1147,1139,1155,1145,1140,1219,1162,1160,1182,1165,1140,1166,1181,1173,1158,1162,1213,1199,1170,1234,1266,1170,1263,1263,1204,1182,1227,1266,1268,1224,1225,1215,1209,1179,1295,1269,1277,1236,1289,1243,1238,1249,1279,1289,1315,1333,1241,1250,1229,1289,1279,1320,1238,1252,1332,1262,1336,1345,1250,1262,1377,1325,1302,1297,1370,1378,1357,1333,1350,1360,1319,1308,1411,1330,1354,1414,1359,1400,1383,1439,1418,1436,1398,1430,1454,1426,1409,1456,1409,1474,1449,1485,1443,1425,1439,1505,1504,1471,1396,1523,1468,1495,1473,1537,1576,1445,1525,1655,1563,1516,1570,1538,1525,1585,1574,1637,1578,1708,1607,1622,1642,1610,1623,1633,1647,1642,1684,1736,1733,1702,1629,1669,1707,1775,1709,1706,1740,1755,1767,1814,1755,1854,1802,1759,1827,1784,1774,1867,1848,1864,1865,1892,1914,1997,1908,1964,1947,1984,1977,1981,1953,1933,1954,1960,1934,2058,2018,2156,2045,2025,2025,2083,2038,2089,2025,2073,2123,2117,2153,2198,2064,2101,2055,2091,2189,2088,2148,2081,2195,2172,2294,2144,2220,2197,2313,2268,2224,2218,2303,2248,2264,2261,2329,2335,2393,2381,2433,2378,2449,2455,2446,2534,2433,2469,2466,2522,2491,2588,2552,2584,2737,2689,2607,2610,2684,2747,2827,2714,2732,2772,2844,2909,2798,2776,2832,2753,2887,2878,2949,2893,3019,2820,2916,2957,3053,3066,3060,3059,3094,3128,3126,3196,3211,3155,3264,3226,3327,3256,3221,3285,3362,3446,3471,3403,3492,3413,3539,3577,3592,3553,3648,3636,3744,3901,3660,3833,3819,3714,3836,3771,3917,3983,3942,4015,3959,4082,4102,4017,4136,4076,4261,4120,4268,4257,4336,4300,4407,4460,4342,4491,4486,4531,4579,4611,4669,4729,4787,4766,4709,4808,4802,4876,4868,4962,4966,4986,5175,5021,5095,5188,5345,5350,5364,5476,5337,5581,5527,5460,5647,5559,5686,5681,5648,5820,5898,5878,5979,5901,6168,6189,6313,6249,6222,6484,6518,6642,6644,6669,6778,6750,6920,6861,6899,7020,7151,7081,7122,7416,7303,7388,7365,7679,7603,7613,7842,7699,8019,7973,8235,8200,8281,8402,8601,8460,8833,8571,8692,9019,9023,8969,9253,9266,9322,9456,9451,9524,9763,9611,9908,9825,10099,10333,10281,10177,10679,10659,10550,10984,10935,11036,11385,11162,11383,11618,11663,11585,11871,12083,12288,12329,12314,12460,12725,12811,12728,12895,13101,13295,13215,13436,13578,13882,13804,13954,14118,14534,14269,14492,14691,15214,15143,15276,15191,15473,15381,16121,15926,16080,16383,16369,16669,16775,17005,17176,17364,17506,17313,17772,18018,18063,18345,18645,18510,18613,18666,19021,19256,19262,19602,19722,19837,20367,20175,20382,20591,21224,20954,21352,21417,21818,21730,21818,22236,22448,22658,22872,22985,23225,23345,23224,23829,23597,24343,24305,24894,24947,24926,25157,25108,25444,25758,26225,26086,26377,26872,26718,26907,27227,27696,27550,28054,28525,28777,28606,28948,29245,30047,29980,30402,30441,30745,31019,31206,31872,32073,32652,32828,33135,33941,33749,34397,34720,35335,35516,36618,36720,37062,37753,37738,38391,38672,39453,40147,40680,41330,42148,42522,43344,44168,44223,45331,46043,46791,47671,48333,49289,49903,51222,51560,52431,53736,54771,55395,56635,57975,58783,60063,60750,61850,63949,64524,66027,67355,68215,69511,71452,73013,74444,75571,76238,79146,80068,81760,83112,84831,86806,88632,90280,91901,93533,95441,97575,99642,101866,103228,105327,107246,109348,110982,113256,114470,116477,119976,121808,123670,125575,127906,130328,132476,134753,136925,139384,141561,143657,145857,148049,150543,153260,154869,157941,159987,162128,163216,166002,167884,170192,172410,174683,176952,178989,180739,183088,184708,187639,189788,191423,192987,195502,198045,199719,201800,203411,204561,207381,208405,210033,212865,213959,215201,217614,219259,221249,222239,224177,225447,226987,227702,229150,230496,232469,233817,234412,236205,236803,238421,238962,240226,241669,241824,242859,243658,245650,246878,246729,247924,248210,249838,250762,251332,252317,252520,253667,253396,255385,254988,255212,255936,255799,256411,257605,257719,259053,258208,259030,260503,260067,259733,259796,260924,260529,262075,262557,262779,262415,263262,263189,263750,263286,265314,264042,264191,263947,264504,264273,265335,265568,266235,266296,266421,266333,266965,267299,266914,267166,267118,268350,267663,268481,267895,268755,269184,268584,268336,268552,268570,269838,269813,270625,269490,270311,270829,270661,270529,271254,270882,271465,271017,270834,271212,271413,271857,270654,271473,271121,271611,271897,271644,272146,271307,272256,271444,271757,271407,271547,270708,271491,272015,271209,272718,272068,271375,271710,272534,272797,274333,275660,275904,276898,277759,278410,279550,280296,282327,283723,284303,287093,288717,291369,293479,296775,298356,301099,304809,308338,311443,313742,317597,320110,324262,327865,330656,335376,337837,342973,345263,349940,352960,356077,360416,363829,365909,368587,370809,373249,374398,378233,378810,380148,379176,379984,380034,378243,377946,375696,373009,371077,367440,363704,358748,355539,349671,342747,337626,329740,322916,316544,307674,298949,290912,281870,272057,263412,252135,243550,234322,223598,214332,203807,194059,183850,175173,164878,156012,146495,137792,129625,121198,113402,106373,98799,91440,84968,78996,73211,67922,62790,57697,53508,49114,45713,42338,38837,35803,32816,30135,28336,26038,23989,22505,21071,19508,18114,16954,16045,15068,13857,13587,12614,12059,11410,11164,10623,10206,9783,9372,9353,8887,8509,8395,8072,7931,7629,7300,7170,6961,6916,6669,6646,6267,6354,6110,5962,5747,5646,5451,5519,5323,5179,5088,4765,4766,4712,4638,4377,4294,4275,4118,3982,3890,3945,3900,3591,3550,3424,3531,3305,3283,3178,3084,2925,2923,2899,2769,2737,2674,2699,2541,2485,2393,2334,2243,2208,2220,2141,2043,2025,1928,1967,1877,1818,1755,1715,1631,1620,1681,1596,1492,1528,1487,1438,1357,1397,1310,1354,1289,1263,1221,1178,1206,1139,1187,1115,1109,1054,1109,1063,1034,1072,1006,1009,921,983,979,929,931,914,908,832,866,881,855,806,812,828,827,795,792,740,806,761,732,746,734,725,725,705,701,720,713,645,679,656,657,655,629,649,629,604,625,641,641,539,612,599,578,579,551,567,551,563,555,537,522,537,567,524,551,536,520,542,523,489,501,515,547,516,458,473,456,446,478,475,475,485,482,492,471,436,455,431,464,455,423,438,401,441,447,416,432,442,432,407,425,433,404,409,380,406,401,386,396,385,400,417,428,406,386,372,365,333,360,379,363,372,363,364,385,393,384,370,357,369,385,351,354,351,342,350,335,355,352,344,337,365,351,310,332,363,334,345,303,317,346,311,325,301,275,334,312,332,316,319,307,290,332,290,299,316,297,314,277,327,324,321,301,300,304,301,291,300,301,258,290,270,282,292,283,265,280,311,250,310,256,285,298,282,318,256,315,276,274,289,241,277,251,270,272,252,266,269,268,272,265,285,244,246,258,263,258,239,254,255,245,231,235,223,251,246,247,239,252,232,253,248,222,237,246,214,250,264,233,255,269,254,266,242,214,243,208,256,273,286,272,257,246,249,247,275,255,253,280,285,257,259,305,289,269,270,281,249,276,274,289,285,286,276,270,269,275,260,264,274,243,273,232,240,238,241,248,236,205,202,191,193,175,202,183,175,189,155,163,153,131,157,114,141,120,118,120,126,117,105,102,98,99,91,116,95,89,94,85,92,82,104,94,90,84,77,82,85,75,87,83,81,87,73,61,66,89,73,68,83,82,75,67,80,77,91,80,70,76,82,68,73,76,73,68,64,69,61,72,63,65,78,68]
    dvt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,9,9,30,33,72,135,228,426,749,1266,2030,3264,5337,8175,12774,18673,27314,38683,54158,73692,99408,130116,166163,208211,254371,303700,356940,408824,458637,502165,539508,566576,581605,585658,575859,554873,520659,480500,434008,383387,331759,281511,234013,191226,151234,118523,91051,68578,50788,36620,26264,18333,12790,8746,5734,3974,2594,1746,1113,752,576,384,302,228,188,152,149,105,97,104,99,97,88,76,75,73,75,75,65,54,51,46,32,33,33,36,27,39,112,129,112,130,132,150,144,156,139,169,206,316,648,1257,2347,3675,4729,5242,5278,5165,5069,5022,4946,5112,4913,4933,4935,4902,4774,4857,4847,4735,4650,4635,4651,4615,4699,4501,4561,4521,4481,4414,4555,4531,4450,4312,4375,4444,4339,4389,4382,4363,4260,4281,4256,4313,4255,4297,4152,4103,4282,4148,4209,4203,4061,4137,4140,4092,4044,4013,3949,4075,4064,3828,4037,3953,3999,3994,3939,4022,3814,3933,3823,3791,3880,3952,3911,3933,3891,3805,3816,3827,3803,3877,4000,3873,3863,3926,3827,3880,3938,3730,3765,3935,3849,3830,3774,3853,3848,3811,3865,3873,3847,3813,3690,3668,3740,3830,3766,3688,3732,3659,3790,3692,3652,3713,3669,3656,3572,3606,3565,3621,3529,3477,3464,3491,3496,3443,3408,3453,3391,3405,3424,3364,3333,3265,3355,3197,3200,3123,3208,3079,2977,3026,2966,3002,2906,2871,2893,3004,2736,2781,2873,2744,2725,2701,2612,2668,2562,2497,2460,2463,2522,2399,2368,2368,2300,2247,2331,2226,2343,2204,2222,2223,2165,2093,2059,2032,2064,2094,2086,1920,2041,1989,2008,1879,1933,1945,1851,1869,1835,1750,1823,1781,1770,1698,1751,1744,1716,1663,1683,1739,1702,1616,1619,1722,1644,1653,1608,1627,1608,1548,1663,1600,1563,1559,1720,1643,1656,1709,1729,1795,1786,1842,1852,1970,1928,1983,2101,2020,2127,2100,2148,2158,2062,2119,2086,2061,2083,2035,2004,2003,2005,1854,1884,1901,1846,1821,1808,1793,1750,1796,1636,1662,1536,1581,1538,1500,1487,1514,1454,1417,1397,1375,1322,1310,1349,1291,1315,1373,1347,1357,1294,1262,1457,1379,1333,1405,1411,1455,1390,1384,1439,1403,1409,1350,1435,1450,1378,1413,1386,1336,1350,1340,1379,1368,1290,1376,1312,1304,1338,1275,1382,1291,1290,1259,1327,1227,1266,1347,1265,1311,1336,1215,1285,1238,1235,1256,1247,1233,1238,1204,1304,1247,1284,1259,1308,1208,1271,1243,1241,1318,1265,1310,1324,1334,1269,1291,1332,1271,1360,1329,1296,1382,1377,1364,1293,1265,1266,1284,1229,1309,1276,1260,1246,1270,1242,1299,1221,1231,1228,1230,1151,1242,1216,1177,1162,1157,1247,1195,1212,1128,1212,1156,1308,1226,1247,1276,1342,1331,1396,1522,1530,1522,1660,1769,1787,1930,2043,2116,2230,2335,2352,2527,2339,2437,2611,2557,2552,2425,2562,2454,2365,2259,2096,2069,1976,1877,1778,1727,1604,1579,1611,1332,1424,1309,1274,1286,1238,1227,1204,1218,1163,1185,1285,1180,1244,1184,1121,1174,1168,1119,1072,1217,1085,1142,1107,1118,1045,1075,1084,1147,1012,1047,1031,1094,1007,1024,970,1046,1103,1030,1086,1063,1042,1084,1018,1057,1119,1077,1064,1022,1024,1084,1011,1036,1054,1048,1022,1006,962,1017,982,992,1036,940,985,1048,1031,986,1015,1054,1013,979,967,926,971,968,939,944,1000,969,950,1029,980,1000,957,960,1038,953,1021,978,1003,982,978,1031,1052,1018,1049,1068,1072,1064,1057,1070,1110,1135,1176,1212,1192,1228,1314,1315,1344,1341,1346,1366,1319,1284,1371,1344,1344,1220,1320,1273,1255,1221,1268,1183,1194,1145,1186,1134,1101,1061,1027,977,1073,1004,1031,1041,1007,941,965,994,978,995,1027,1026,974,1044,1075,1069,1072,1135,1198,1188,1242,1292,1507,1591,1748,1932,2040,2384,2779,3145,3547,4200,4790,5653,6521,7509,8503,9834,11057,12558,13829,15215,17067,18530,19909,21491,22647,23998,25102,25504,26440,27068,27054,27107,26559,26225,25003,24036,23114,21752,20577,18783,17142,15613,14048,12726,11509,9965,8795,7507,6686,5685,5015,4260,3660,3309,2758,2378,2139,1940,1740,1638,1557,1473,1493,1573,1494,1552,1643,1705,1906,1968,2062,2272,2457,2514,2734,2909,3195,3355,3577,3690,3955,4163,4169,4343,4572,4689,4836,4925,5020,5161,5052,5204,5503,5537,5540,5479,5567,5686,5629,5736,5820,5847,5873,5612,5794,5578,5674,5483,5275,5069,4838,4674,4491,4214,3979,3694,3450,3123,2980,2740,2466,2182,2038,1839,1714,1577,1487,1215,1218,1150,1124,1016,975,960,893,866,859,819,872,818,763,825,861,837,857,803,833,866,815,885,876,893,918,1000,994,1032,1065,1076,1025,1046,1118,1157,1185,1194,1232,1236,1286,1271,1299,1349,1330,1313,1258,1280,1258,1217,1222,1205,1183,1151,1097,1041,1051,1079,989,933,977,926,879,881,841,835,763,773,742,794,758,716,738,721,787,763,775,723,757,703,752,755,744,786,711,714,710,751,651,698,713,729,751,767,728,728,732,753,751,721,710,698,738,693,725,682,719,747,754,725,726,715,696,731,792,729,777,759,809,774,826,865,828,811,882,930,917,1016,995,1045,1114,1065,1129,1126,1202,1220,1271,1236,1314,1311,1338,1351,1309,1350,1274,1320,1275,1327,1256,1258,1236,1253,1178,1140,1124,1130,1137,1108,1033,978,934,981,893,944,961,947,913,921,908,908,901,877,902,858,887,853,874,829,845,822,835,848,743,811,818,794,765,787,749,749,765,705,752,712,724,771,720,705,730,727,736,811,726,733,786,758,744,822,789,757,798,745,798,781,772,795,794,782,776,821,823,808,760,836,800,797,802,756,853,806,793,813,740,743,759,766,728,753,780,764,765,789,701,721,700,700,716,713,695,741,634,705,675,681,741,672,707,696,686,699,694,747,740,698,651,688,726,692,702,714,707,674,637,727,695,672,726,690,723,733,705,724,719,719,753,775,751,802,746,723,756,814,756,733,760,729,734,765,714,694,758,763,749,740,812,732,743,741,747,745,785,740,767,725,746,769,800,752,773,786,773,739,806,755,757,740,787,743,738,794,733,749,742,769,719,727,718,769,713,712,717,689,726,694,702,695,700,663,728,685,665,714,704,654,705,674,658,760,703,699,685,669,691,666,663,620,714,670,664,685,706,673,656,704,697,714,723,689,652,719,680,722,626,670,713,688,662,733,758,699,716,688,756,726,722,716,739,750,690,739,778,754,775,767,793,792,834,878,821,838,841,850,913,894,941,948,950,916,981,1006,949,949,923,897,927,911,903,920,881,914,909,887,844,777,787,848,775,799,797,744,777,766,743,739,787,757,777,764,700,718,727,739,724,778,712,757,783,818,772,737,785,748,750,759,794,805,781,782,797,799,844,860,798,867,855,939,935,925,929,973,1042,1140,1242,1330,1449,1597,1748,1989,2180,2410,2809,3313,3729,4193,4801,5445,6303,7066,8160,9081,10303,11779,12744,14327,15792,17301,18940,20385,22621,23614,25705,26949,28618,29681,31080,32451,33058,34002,34291,34588,34845,35059,34390,33857,33414,32450,30985,29789,28817,27282,25747,24169,22427,20992,19310,17626,15908,14426,13148,11676,10404,9080,8290,7176,6340,5447,4790,4121,3574,3141,2784,2412,2053,1900,1614,1386,1289,1220,1170,1013,915,904,895,841,756,760,771,704,672,752,763,696,732,681,672,700,644,691,701,694,666,694,663,668,676,684,656,713,666,713,680,669,682,636,708,703,693,718,706,708,699,663,715,719,682,725,736,746,738,700,753,727,797,768,752,834,911,898,984,1025,1055,1138,1139,1273,1270,1396,1537,1586,1715,1849,1989,2119,2248,2443,2557,2774,3048,3222,3341,3548,3717,3967,4237,4244,4521,4625,4793,4785,4928,5014,5118,4773,5050,4782,5084,4769,4742,4547,4451,4290,4051,3907,3697,3501,3376,3104,2948,2706,2444,2251,2194,2016,1870,1719,1609,1508,1373,1293,1178,1128,1044,933,937,895,832,795,767,803,716,657,656,692,696,658,617,611,630,654,588,608,612,641,570,579,619,591,610,616,601,602,633,614,635,575,657,641,665,618,670,664,695,633,641,688,688,667,708,673,691,670,668,686,702,741,749,722,719,704,707,719,693,676,702,672,680,662,687,690,635,662,646,641,659,622,650,574,601,623,650,640,565,611,574,609,601,603,618,615,576,603,568,604,637,604,574,575,606,608,622,599,551,609,608,625,594,609,579,609,613,613,580,594,597,616,613,618,616,607,626,625,616,623,598,649,626,625,587,614,600,622,639,634,638,684,636,646,647,612,622,611,616,671,615,689,687,633,657,704,708,645,700,711,726,715,679,713,789,744,744,709,734,791,790,763,749,857,779,778,787,769,804,718,782,769,799,748,760,753,762,719,698,737,721,683,678,674,686,671,633,706,673,666,633,668,637,612,621,632,638,651,650,595,647,603,646,657,626,631,614,602,629,594,617,574,602,630,639,641,649,616,615,614,635,626,595,643,619,596,663,694,647,589,627,566,657,618,658,681,640,629,648,597,628,652,603,651,666,634,642,617,621,664,691,664,632,633,678,691,672,665,677,715,728,745,760,766,782,772,824,852,832,891,947,919,885,871,974,994,1031,1000,1029,1057,1050,1005,1070,1053,1108,1094,1109,1023,1030,964,1012,989,979,964,917,906,896,878,849,857,864,840,803,796,721,769,745,698,704,686,693,709,671,636,637,639,650,680,658,670,617,623,613,647,650,639,657,623,603,631,602,653,665,647,613,626,672,639,654,630,661,619,667,645,647,642,631,675,596,618,656,603,660,635,646,590,636,598,683,634,636,623,631,663,635,612,666,613,627,638,634,708,711,626,671,684,674,629,662,682,717,702,681,696,680,665,758,708,707,742,700,771,750,738,806,800,769,845,822,797,792,834,835,814,800,836,848,794,831,815,821,791,818,805,750,811,769,722,773,748,749,770,742,745,684,733,692,693,678,746,708,668,687,689,648,650,645,721,679,634,631,604,634,628,627,686,692,633,692,682,656,659,611,674,650,621,662,644,657,652,675,690,685,705,673,671,647,710,662,650,702,682,672,676,653,687,656,704,684,709,701,693,670,685,677,634,702,661,656,649,671,719,680,692,709,628,706,616,661,687,653,694,635,665,628,638,596,702,631,620,685,616,678,670,670,634,674,640,615,638,691,635,623,642,663,633,667,648,669,644,670,635,647,667,657,636,622,664,668,675,633,652,678,695,651,663,684,644,619,634,646,678,656,613,681,617,670,660,615,629,691,644,624,610,651,664,627,617,672,629,626,618,674,592,613,653,638,680,668,652,670,663,690,682,680,658,646,660,661,683,629,646,671,702,687,664,627,657,668,686,645,675,694,674,696,701,670,677,689,626,695,686,694,672,694,671,686,699,700,675,665,705,691,700,669,723,675,708,676,692,719,729,730,667,756,736,740,796,701,790,781,823,758,824,851,836,838,890,852,912,883,903,951,917,941,948,979,974,969,982,1019,983,1028,1000,983,1022,1025,1035,1030,931,1003,975,1001,988,924,988,980,965,966,861,940,920,876,885,814,847,795,823,778,816,748,814,775,712,739,767,722,713,750,711,678,713,676,697,674,696,683,635,711,693,703,676,702,711,661,712,685,702,652,674,650,663,654,641,713,698,650,681,683,739,651,675,687,704,762,695,687,682,718,681,696,684,669,669,687,699,702,678,671,674,701,659,672,691,678,648,692,690,652,688,722,664,649,690,700,696,723,656,657,675,695,664,646,698,693,677,671,688,667,732,711,715,762,629,692,634,715,715,725,730,683,666,683,655,705,673,692,666,644,650,698,684,710,696,740,669,698,722,681,697,677,737,737,672,630,717,688,686,660,714,666,706,701,661,696,686,695,688,677,701,682,669,726,725,719,681,662,717,684,673,724,705,722,663,707,685,701,713,735,684,715,711,700,735,698,747,753,636,684,729,645,723,711,708,761,762,712,714,720,712,759,683,697,743,700,692,739,759,713,707,734,735,739,688,688,707,748,720,710,729,746,769,723,753,764,725,739,749,749,760,757,722,728,701,711,732,737,724,755,784,743,730,789,724,713,776,794,764,747,772,798,759,751,743,808,778,756,830,843,792,820,843,816,782,810,761,795,814,751,824,802,806,809,816,797,765,804,799,756,833,801,858,797,777,799,722,798,729,785,800,729,777,823,820,753,731,765,814,757,731,745,735,742,799,749,821,768,768,790,730,741,749,782,788,808,729,801,738,768,755,816,794,786,786,812,778,755,738,760,754,750,759,751,757,784,843,779,776,765,818,814,857,803,782,820,798,789,744,823,838,826,765,762,794,808,817,810,822,783,834,799,826,848,814,805,820,839,774,837,860,826,804,817,850,825,830,873,894,913,878,877,889,883,918,888,945,907,962,969,943,960,965,1064,1026,1037,1049,1033,1076,1011,1039,1071,1082,1068,1096,1135,1154,1105,1174,1136,1094,1114,1152,1115,1179,1194,1157,1115,1141,1076,1157,1083,1096,1120,1044,1076,1070,1023,1069,1072,1047,990,985,961,1079,1029,979,989,1000,1020,1012,993,1022,984,963,1011,913,984,1012,967,962,1006,968,1004,968,989,1016,1030,993,978,1022,1014,1027,1042,1054,1033,1065,1125,1025,1044,1029,1069,1029,1079,1087,1004,1034,1114,1124,1119,1105,1103,1141,1129,1141,1090,1058,1063,1058,1061,1107,1148,1067,1056,1080,1034,1040,1061,1087,1041,1043,1055,1071,1056,1102,1025,1102,1041,1073,1081,1094,1096,1044,1053,1081,1164,1254,1219,1212,1207,1271,1383,1459,1464,1483,1554,1612,1638,1776,1858,2000,2080,2154,2369,2395,2520,2670,2779,2901,3077,3087,3370,3498,3746,3763,4010,4186,4219,4457,4502,4710,4975,4999,5068,5245,5277,5335,5392,5549,5516,5458,5557,5516,5499,5524,5501,5398,5253,5171,5168,4945,4919,4735,4712,4480,4239,4147,4056,3961,3845,3708,3424,3278,3226,3056,2949,2728,2702,2478,2398,2248,2199,2078,2069,1900,1859,1826,1762,1619,1604,1608,1534,1513,1516,1436,1435,1404,1363,1372,1359,1320,1320,1323,1320,1355,1289,1332,1325,1354,1275,1246,1286,1262,1257,1288,1288,1221,1278,1274,1295,1287,1207,1218,1307,1254,1287,1298,1319,1280,1262,1260,1333,1260,1269,1286,1369,1301,1289,1344,1344,1318,1343,1275,1339,1316,1343,1352,1312,1368,1351,1376,1349,1418,1325,1457,1411,1424,1372,1447,1357,1441,1443,1498,1387,1461,1401,1483,1435,1492,1485,1455,1500,1492,1506,1508,1527,1498,1570,1570,1641,1596,1598,1592,1635,1648,1651,1686,1674,1729,1736,1727,1796,1721,1789,1753,1772,1807,1822,1829,1798,1776,1811,1890,1846,1895,1845,1880,1877,1868,1933,1864,1818,1889,1822,1894,1923,1980,1950,1980,1945,1881,1999,1903,1939,1922,1973,1940,2049,1957,1914,1899,1951,1932,1969,1960,1999,2020,2053,2011,1966,2121,1975,2045,2031,2087,2132,2090,2055,2156,2148,2132,2217,2102,2067,2097,2117,2150,2249,2260,2311,2258,2226,2212,2242,2254,2280,2306,2386,2296,2321,2404,2329,2394,2427,2402,2376,2491,2407,2491,2490,2585,2593,2611,2609,2417,2631,2622,2694,2598,2642,2675,2719,2723,2687,2831,2765,2791,2819,2808,2838,2901,2884,3030,2977,3055,3002,2923,3059,3163,3128,3068,3174,3118,3264,3156,3279,3371,3382,3213,3326,3443,3504,3424,3557,3516,3623,3673,3722,3719,3851,3763,3915,3873,3983,4150,4114,4150,4229,4240,4228,4382,4444,4630,4723,4717,4774,4900,4883,4898,5123,5053,5198,5155,5321,5378,5568,5507,5662,5718,5750,5945,5910,5827,5885,5986,6003,5880,6152,6043,6078,6094,6073,6170,6101,6100,6186,6224,6200,6179,6067,6124,6180,6115,6182,6081,6359,6205,6076,6260,6228,6262,6245,6294,6422,6268,6306,6375,6312,6301,6600,6545,6481,6544,6707,6728,6807,6871,6764,6853,6908,6894,7224,7041,7076,7269,7388,7322,7457,7465,7745,7565,7824,7943,8048,7937,7806,8105,8002,8307,8331,8186,8512,8384,8754,8758,8783,8842,8805,9019,9303,9300,9301,9227,9528,9356,9430,9877,9622,9982,10133,10144,10252,10272,10320,10429,10509,10724,10899,11038,11098,11308,11288,11582,11612,11740,11705,11838,12147,12195,12350,12199,12589,12488,12842,12891,12838,13227,13245,13528,13456,13655,13893,13905,13840,14344,14434,14318,14753,14851,14803,14957,15185,15228,15435,15572,15947,15915,15960,16244,16462,16415,16666,16622,17072,17138,17582,17512,17840,17841,17945,18083,18575,18657,18887,18885,18917,19225,19205,19742,19656,19864,19949,20246,20427,20519,20631,20991,21079,21169,21637,21511,22024,21809,22120,22298,22714,22726,22873,23141,23492,23576,23541,23689,23906,24120,24584,24399,24721,25112,25330,25718,25682,25981,25954,26456,26634,27099,27525,27331,27996,27884,28331,28820,29000,29631,29712,30004,30340,30935,30832,31515,31720,32299,32550,33020,33451,33919,34400,34814,35429,35840,36655,36820,37315,37849,38507,39381,40032,40292,40972,41965,42169,42984,43808,44226,45357,45551,46471,47662,48628,49171,50214,50958,51788,52293,53744,54917,55432,57215,57614,58837,59966,60929,62041,63327,64345,66021,67104,68540,69370,70747,71833,73774,75119,76653,77828,79561,80506,82587,84174,85308,87145,88408,90055,92770,93890,95350,97089,98936,100692,102897,104341,106116,107741,109248,111522,113512,114892,116347,118181,120519,122142,124162,126606,128115,130080,131921,133781,136048,137129,139716,141415,143326,146492,147725,148976,150743,152953,155251,156563,158437,161112,161143,163607,165078,167519,169164,170592,172692,173627,176254,178038,179192,181038,181100,184166,185488,186681,187570,189895,190648,191956,193798,194943,196085,197801,197817,200227,200759,202461,203869,205386,206141,207017,207938,209060,210164,210550,211556,212811,213595,214306,215396,217238,216505,217751,218773,218600,219403,219701,221259,221951,220574,221946,223316,223903,224826,224533,224810,225807,226365,226623,227091,226924,226973,227547,227922,228448,229497,229213,229336,230221,230547,229685,231526,231485,230143,231570,231583,231618,231219,233154,232007,232475,233218,232507,233293,233137,232878,232841,233311,232924,233557,233807,234653,234574,233884,233488,234138,233469,235017,234423,234625,234936,235031,234211,233434,234119,234910,235304,235000,235112,235209,234225,234243,234312,234316,234418,233343,233344,233540,233178,232147,232957,232253,231840,232120,231005,231421,231016,230954,230484,230163,230521,229571,229127,229901,229754,229202,229180,229893,229528,229386,229607,229850,230776,231038,231637,232187,232676,234090,235992,236667,237377,238479,241328,242034,244991,246720,249025,251713,253602,256699,258310,260948,265203,266900,269406,272786,275962,279089,281669,284445,286776,288936,292192,295297,297353,298653,300638,303836,304594,306772,307532,306867,308498,308469,307399,308379,306162,304511,303337,301681,299006,294989,292560,289118,284335,278921,273940,268806,263573,257459,250338,243955,237715,230528,222794,215284,207714,199753,190849,183386,175471,167687,159251,151603,143613,136021,128520,120800,114200,106651,100093,93498,87161,81481,76138,70594,65435,60761,55972,51704,48073,43983,40814,37861,34667,31794,29358,27503,25075,23070,21331,20026,18328,17034,16000,14769,13988,12986,12591,11740,10851,10398,9805,9386,8930,8553,8128,7899,7717,7496,7086,6951,6735,6560,6301,6263,6247,5935,5894,5819,5643,5459,5609,5242,5199,5013,4996,5065,4846,4788,4542,4569,4520,4395,4257,4205,4196,4086,4060,3915,3963,3699,3739,3650,3582,3462,3408,3347,3290,3273,3195,3198,2994,2963,2877,2931,2863,2746,2756,2635,2632,2535,2584,2534,2366,2388,2471,2308,2271,2184,2103,2099,2051,1941,2006,1924,1841,1789,1794,1824,1682,1727,1655,1687,1643,1601,1587,1577,1489,1451,1510,1396,1366,1415,1329,1369,1313,1282,1254,1258,1258,1167,1163,1136,1176,1094,1082,1070,1022,1054,1009,966,1075,924,921,945,894,869,866,884,852,794,842,863,752,812,785,797,748,794,720,751,671,733,702,673,680,698,686,656,627,637,618,623,637,639,614,620,582,569,588,560,553,564,520,582,554,532,495,541,505,521,514,512,526,499,512,481,530,481,485,461,473,440,456,467,442,448,495,471,448,475,423,479,441,429,417,418,427,462,401,425,449,392,403,369,411,397,357,391,388,385,409,358,378,388,408,362,390,366,387,363,380,348,346,418,359,380,363,359,344,343,365,342,346,333,337,333,363,367,328,333,333,307,333,356,314,326,302,319,327,322,289,306,326,339,302,316,323,306,302,299,303,305,288,311,312,303,287,323,279,314,268,323,275,304,288,280,336,252,309,285,293,290,277,278,269,245,279,276,295,280,276,291,238,276,271,252,243,244,270,262,264,243,249,272,252,258,270,233,236,244,266,243,229,222,226,210,250,229,225,256,220,240,211,221,244,260,243,234,253,220,213,235,193,224,209,216,202,211,198,214,189,252,228,209,208,212,250,249,240,234,235,231,235,241,248,263,235,235,244,297,256,245,264,270,267,284,283,260,298,270,287,277,249,304,271,285,295,250,262,259,255,267,287,251,280,249,232,221,239,220,216,250,224,213,188,187,203,209,202,191,174,172,172,174,171,138,145,154,150,117,129,138,137,148,111,111,126,110,120,106,104,113,115,115,103,85,101,99,88,85,95,104,97,107,86,94,88,90,78,87,94,94,108,87,97,99,91,97,111,92,107,109,99,99,124,89,89,87,101,81,96,85,88,79]
    #y=np.array(channels)
    y=np.array(dvt)
    xl=len(y)
    x=np.arange(xl)
    fwhm_mult=2.5
    def cut(x0,hw):
        ix0=math.floor(x0+0.5)
        ihw=math.floor(hw+0.5)
        xmin=math.floor(ix0-ihw)
        if xmin<0:
            xmin=0
        xmax=math.floor(ix0+ihw)
        if xmax>=xl:
            xmax=xl-1
        return xmin,xmax

    def of(X, xw):
        x0,A, fwhm,b,k =X
        _=gauss(xw, x0, A, fwhm)+b+k*(xw-x0)
        return _
    def r_line(x0, A=None, fwhm=10, xtol=1e-8, width=None, plot=False):
        def fopt(X, xw, yw):
            _=of(X, xw)
            return sum((yw-_)**2)
        if width == None:
            width=fwhm
        hw=width/2.
        xmin,xmax=cut(x0, hw)
        if A == None:
            A=max(y[xmin:xmax])
            #print A
        X0=np.array([x0, A, fwhm, 0,0], dtype=float)
        xw=x[xmin:xmax]
        yw=y[xmin:xmax]
        Xopt=op.fmin(fopt, X0, args=(xw,yw), xtol=xtol, maxiter=10000, maxfun=10000)
        x0, A, fwhm, b, k =Xopt
        nxw=np.arange(xw[0], xw[-1], 0.25)
        fy=of(Xopt, nxw)
        if plot:
            p.fill_between(nxw,fy,(nxw-x0)*k+b, color=(0.7,0.3,0), alpha=0.5)
        return Xopt

    def ofp(X, xw):
        x0,A, fwhm, a0, a1 =X
        dxw=(xw-x0)
        _=gauss(xw, x0, A, fwhm)+a0+a1*dxw
        return _

    def r_line_zr(x0, A=None, fwhm=None, xtol=1e-8, width=None, plot=False):

        def fopt(X, x0, fwhm, xw, yw):
            A, a0, a1 = X
            X=[x0, A, fwhm, a0, a1]
            _=ofp(X, xw)
            return sum((yw-_)**2)

        if fwhm==None:
            raise ValueError, "fwhm should be defined"
        if width == None:
            width=fwhm
        hw=width/2.
        xmin,xmax=cut(x0, hw)
        if A == None:
            A=max(y[xmin:xmax])
            #print A
        X0=[A, 0,0]
        xw=x[xmin:xmax]
        yw=y[xmin:xmax]
        Xopt=op.fmin(fopt, X0, args=(x0, fwhm, xw,yw), xtol=xtol, maxiter=10000, maxfun=10000)
        A, a0, a1 =Xopt
        nxw=np.arange(xw[0], xw[-1], 0.25)
        Xopt=[x0, A, fwhm, a0, a1]
        fy=ofp(Xopt, nxw)
        ffy=ofp([x0,A,fwhm,a0,0.], x)
        if plot:
            dnxw=nxw-x0
            p.fill_between(nxw,fy,a0+a1*dnxw, color=(0.7,0.3,0), alpha=0.5)
            p.plot(x,ffy, color=(0.7,0.0,0.3), alpha=0.5)
        return Xopt


#    X0=np.array([80, np.max(y), 100, 0,0], dtype=float)
    e_fe= 6.4
    e_0 = 0.0086
    e_mo= 17.41
    e_zr= 15.774
    e_ca= 3.692
    p.plot(x,y)
    p.plot(x,x*0.)
    x00, _, fwhm_0, b0, k0= r_line(80, width=len(x)/50, plot=True)
    print "FWHM0:", fwhm_0
    #fwhm_0=100
    w=15*fwhm_0/2.
    #x0_fe, _, fwhm_fe, b_fe, k_fe = recog(1370, fwhm=fwhm_0, width=w) # Fe
    x0_ca, _, fwhm_ca, b_ca, k_ca = r_line(830, fwhm=fwhm_0, width=w, plot=True) # Fe
    s_k=(e_ca-e_0)/(x0_ca-x00)
    s_b=e_ca - (s_k*x0_ca)
    print "Scale:", s_k, s_b
    def to_chan(e):
        return (e-s_b)/s_k
    x0_mo=to_chan(e_mo)
    x0_zr=to_chan(e_zr)
    x0_ca=to_chan(e_ca)
    #r_line(1000, fwhm=fwhm_0, width=w, plot=True)
    #recog(3255, fwhm=fwhm_0, width=w/2.)
    #recog(x0_mo, fwhm=fwhm_0, width=w, plot=True)
    _y=np.array([fwhm_0, fwhm_ca])

    def ffwhm(k, x):
        return _y-np.sqrt(x)*k

    k = op.leastsq(ffwhm, [1], args=np.array([e_0, e_ca]))

    fwhm_zr=k[0]*math.sqrt(e_zr)
    fwhm_mo=k[0]*math.sqrt(e_mo)

    fwhm_ca=k[0]*math.sqrt(e_ca)

    #X=r_line(2920, fwhm=fwhm_0, width=w)
    #fwhm_X=math.sqrt((X[0]-b_fwhm)/k_fwhm)
    #r_line_fix(X[0], fwhm=fwhm_zr, width=w, plot=True)

    #r_line(1821, fwhm=fwhm_0, width=w, plot=True)
    print "fwhm:", fwhm_zr, k

    gain=1/s_k

    def Gc(E, E0, fwhm, fg):
        sigma = fwhm/fwhm_coef
        _1=sigma*fg
        _ = (sqrt_2pi*_1)
        _ = 1/_
        dE=E-E0
        _x= -((dE/_1)**2)/2.
        return _*np.exp(_x)

    def T(E, E0, fwhm, g, mult=1.):
        sigma = fwhm/fwhm_coef
        dE=E-E0
        _ef=math.exp(-1/(2*g**2))
        _0=g*sigma
        _1=2*_0*_ef
        _exp1=np.exp(mult*dE/_0)/_1
        _x=mult*dE/(sqrt_2*sigma)+1./(sqrt_2*g)
        return _exp1*fn.erfc(_x)

    def cou_approx(A, E, E0, fwhm, fg, fa, fb, ga, gb):
        #print (E, E0, fwhm, fg, fa, fb, ga, gb)
        _  = 0.0
        _ += Gc(E, E0, fwhm, fg)
        #_ += fa*T(E, E0, fwhm, ga)
        #_ += fb*T(E, E0, fwhm, gb, mult=-1)
        return A*_ #+ ofp([x0_mo, A_mo, fwhm, a0, a1], E)

    def cou_opt(X,  Ew, E0, fwhm, yw):
        #print X
        A, fg, fa, fb, ga, gb = X
        return sum((cou_approx(A, Ew, E0, fwhm, fg, fa, fb, ga, gb)-yw)**2)

    def cou_fmin(E, E0, fwhm, X0=None, xtol=1e-3, xmin=0, xmax=None):
        if X0 == None:
            X0 = [1., 1, 1., 1., 1, 1]
        if xmax == None:
            xmax=len(E)
        Ew=E[xmin:xmax]
        yw=y[xmin:xmax]
        return op.fmin(cou_opt, X0, args=(Ew, E0, fwhm, yw), xtol=xtol, maxiter=10000, maxfun=10000)

    def cou_sim(A_mo, x_cou, A_cou, fwhm_cou, bkg,    x_mo, fwhm_mo, xw):
        _  = 0.0
        _ += gauss(xw, x_mo, A_mo, fwhm_mo)
        _ += gauss(xw, x_cou, A_cou, fwhm_cou)
        _ += bkg
        return _

    def cou_sim_opt(X, x_mo, fwhm_mo, xw, yw):
        A_mo, x_cou, A_cou, fwhm_cou, bkg = X
        _ = cou_sim(A_mo, x_cou, A_cou, fwhm_cou, bkg,  x_mo, fwhm_mo, xw)
        _ = sum((_-yw)**2)
        return _

    def cou_sim_fmin(X, x_mo, fwhm_mo, xmin=0, xmax=None, xtol=1e-8):
        if xmax == None:
            xmax=len(E)
        xw=x[xmin:xmax]
        yw=y[xmin:xmax]
        return op.fmin(cou_sim_opt, X, args=(x_mo, fwhm_mo, xw, yw),
            xtol=xtol, maxiter=10000, maxfun=10000)


    r_line_zr(x0_zr, fwhm=fwhm_zr, width=fwhm_zr*1.1, plot=True)
    r_line_zr(x0_ca, fwhm=fwhm_ca, width=fwhm_ca*1.1, plot=True)
    Xtry = _, A_mo, _,a0,a1 = r_line_zr(x0_mo, fwhm=fwhm_mo, width=fwhm_zr*1.1, plot=True)
    print "Releigh pike:", Xtry
    #p.show()
    #Coumpton Pike
    angle=90-2 #(degrees)
    rangle=angle*math.pi/180
    m0=510.996
    #E0=e_mo
    #Ec=E0 #seq(15.0,17.415, by=0.1)
    #DE=(E0*Ec/m0)*(1-math.cos(rangle))
    #print "DE:", DE

    E=e_mo
    E_prime=E/(1+(1-math.cos(rangle))*E/m0)

    #x0_coumpton=to_chan(e_mo-DE)
    x0_coumpton=to_chan(E_prime)
    #p.plot(x, 6000000*Gc(x,x0_coumpton, fwhm=fwhm_mo, fg=2.))
    #p.plot(x, 3000000*T(x,x0_coumpton, fwhm=fwhm_mo, g=2))
    #p.plot(x, 3000000*T(x,x0_coumpton, fwhm=fwhm_mo, g=2, mult=-1))

    xmin,xmax=3100,3750

    """
    y1=y+0.
    Xtry[-1]=Xtry[-2]=0.
    y1[3514:3640]=y1[3514:3640]-ofp(Xtry, x[3514:3640])
    y2,y=y,y1
    p.plot(x, y)
    """

    #Xopt=[A, fg, fa, fb, ga, gb]=cou_fmin(x, x0_coumpton,
    #    fwhm_mo, xmin=xmin, xmax=xmax)
    #p.plot(x[xmin:xmax], cou_approx(A, x[xmin:xmax], x0_coumpton, fwhm_mo,
    #    fg, fa, fb, ga, gb)+ofp(Xtry, x[xmin:xmax])) # Need a common amplitude
    #p.plot(x, cou_approx(2.3e6, x, x0_coumpton, fwhm_mo,
    #    2.0, 1, 1, 10, 9, 0.,x0_mo)) # Need a common amplitude
    Xopt_cou=[A_mo, x0_cou, A_cou, fwhm_co, bkg_cou]=cou_sim_fmin([A_mo, x0_coumpton, A_mo, fwhm_mo*2.5, 0.],
        x0_mo, fwhm_mo, xmin=xmin, xmax=xmax)
    xmin-=300
    xmax+=300
    print "Coumpton group:", Xopt_cou
    _cs=cou_sim(A_mo, x0_cou, A_cou, fwhm_co, bkg_cou, x0_mo, fwhm_mo, x[xmin:xmax])
    p.plot(x[xmin:xmax], _cs) # Need a common amplitude

    y1=y+0.
    Xtry[-1]=Xtry[-2]=0.
    y1[xmin:xmax]=y1[xmin:xmax]-_cs+bkg_cou
    y2,y=y,y1
    p.plot(x, y)
    r_line_zr(x0_zr, fwhm=fwhm_zr, width=fwhm_zr*1.1, plot=True)

    p.show()


if __name__=='__main__':
    test1()
